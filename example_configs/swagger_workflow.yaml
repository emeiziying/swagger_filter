# å®Œæ•´çš„ Swagger å¤„ç†å·¥ä½œæµé…ç½®
# æ–‡ä»¶: build.yaml

targets:
  $default:
    builders:
      # é˜¶æ®µ1: swagger_filter - è¿‡æ»¤å’Œæ¸…ç†APIæ–‡æ¡£
      swagger_filter:
        enabled: true
        options:
          output_dir: "./swagger_filtered"
      
      # é˜¶æ®µ2: swagger_dart_code_generator - ç”ŸæˆDartä»£ç 
      swagger_dart_code_generator|swagger:
        enabled: true
        options:
          input_folder: "./swagger_filtered"
          output_folder: "./lib/api"
          separate_models: true
          use_default_null_for_lists: true
          build_only_models: false
          default_values_map:
            - type_name: int
              default_value: "0"
        generate_for:
          include:
            - "swagger_filtered/**"

---
# æ–‡ä»¶: swagger_filter.yaml

swaggers:
  # ç”¨æˆ·API - åªä¿ç•™æ ¸å¿ƒç”¨æˆ·åŠŸèƒ½
  - source: "https://api.example.com/v1/swagger.json"
    output: "user_api.json"
    include_paths:
      - "/api/v1/auth/login"
      - "/api/v1/auth/logout" 
      - "/api/v1/users/profile"
      - "/api/v1/users/settings"
    exclude_tags: ["admin", "internal"]
    
  # å•†å“API - åªä¿ç•™å…¬å¼€å•†å“æ¥å£
  - source: "https://api.example.com/v1/swagger.json"
    output: "product_api.json"
    include_paths:
      - "/api/v1/products"
      - "/api/v1/categories"
    include_tags: ["public"]
    
  # è®¢å•API - æ’é™¤æ•æ„Ÿç®¡ç†æ¥å£
  - source: "https://api.example.com/v1/swagger.json"
    output: "order_api.json"
    include_paths:
      - "/api/v1/orders"
      - "/api/v1/cart"
    exclude_paths:
      - "/api/v1/orders/admin"
      - "/api/v1/orders/reports"

output_dir: "./swagger_filtered"

---
# æ‰§è¡Œæµç¨‹å’Œç»“æœ

## æ‰§è¡Œå‘½ä»¤
```bash
dart run build_runner build --delete-conflicting-outputs
```

## æ‰§è¡Œé¡ºåº
1. **swagger_filter** (ç¬¬ä¸€é˜¶æ®µ)
   - è¯»å– swagger_filter.yaml é…ç½®
   - ä»è¿œç¨‹/æœ¬åœ°åŠ è½½åŸå§‹Swaggeræ–‡æ¡£
   - æ ¹æ®include_paths/exclude_pathsè¿‡æ»¤APIç«¯ç‚¹
   - ç”Ÿæˆè¿‡æ»¤åçš„æ–‡æ¡£åˆ° ./swagger_filtered/
   
2. **swagger_dart_code_generator** (ç¬¬äºŒé˜¶æ®µ)
   - è¯»å– ./swagger_filtered/ ä¸­çš„è¿‡æ»¤åæ–‡æ¡£
   - ç”Ÿæˆå¯¹åº”çš„Dartæ¨¡å‹å’ŒAPIå®¢æˆ·ç«¯ä»£ç 
   - è¾“å‡ºåˆ° ./lib/api/ ç›®å½•

## æ–‡ä»¶ç»“æ„
```
project/
â”œâ”€â”€ build.yaml                    # build_runneré…ç½®
â”œâ”€â”€ swagger_filter.yaml           # swaggerè¿‡æ»¤é…ç½®
â”œâ”€â”€ swagger_filtered/              # è¿‡æ»¤åçš„swaggeræ–‡æ¡£
â”‚   â”œâ”€â”€ user_api.json
â”‚   â”œâ”€â”€ product_api.json
â”‚   â””â”€â”€ order_api.json
â””â”€â”€ lib/
    â””â”€â”€ api/                       # ç”Ÿæˆçš„Dartä»£ç 
        â”œâ”€â”€ user_api.dart
        â”œâ”€â”€ product_api.dart
        â”œâ”€â”€ order_api.dart
        â””â”€â”€ models/
            â”œâ”€â”€ user.dart
            â”œâ”€â”€ product.dart
            â””â”€â”€ order.dart
```

## ä¼˜åŠ¿
- ğŸ”’ **å®‰å…¨æ€§**: åªç”Ÿæˆéœ€è¦çš„APIï¼Œé¿å…æš´éœ²æ•æ„Ÿæ¥å£
- ğŸ“¦ **ä½“ç§¯ä¼˜åŒ–**: å‡å°‘ç”Ÿæˆä»£ç çš„å¤§å°
- ğŸš€ **æ€§èƒ½**: è¾ƒå°‘çš„APIæ„å‘³ç€æ›´å¿«çš„ç¼–è¯‘å’Œè¿è¡Œ
- ğŸ¯ **ä¸“æ³¨æ€§**: æ¯ä¸ªæ¨¡å—åªåŒ…å«ç›¸å…³çš„APIåŠŸèƒ½
- ğŸ”„ **è‡ªåŠ¨åŒ–**: ä¸€æ¬¡é…ç½®ï¼Œè‡ªåŠ¨åŒ–å¤„ç†å®Œæ•´å·¥ä½œæµ 